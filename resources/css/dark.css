[data-bs-theme="dark"] {
    /* General body and text colors */
    color: var(--tblr-body-color);
    background-color: var(--tblr-body-bg);
}

[data-bs-theme="dark"] .card {
    background-color: var(--tblr-bg-surface);
    color: var(--tblr-body-color);
    border-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .card-header {
    background-color: var(--tblr-bg-surface-secondary);
    border-bottom-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .card-footer {
    background-color: var(--tblr-bg-surface-secondary);
    border-top-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .modal-content {
    background-color: var(--tblr-bg-surface);
    color: var(--tblr-body-color);
    border-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .modal-header {
    background-color: var(--tblr-bg-surface-secondary);
    border-bottom-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .modal-footer {
    background-color: var(--tblr-bg-surface-secondary);
    border-top-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .table {
    color: var(--tblr-body-color);
}

[data-bs-theme="dark"] .table thead th {
    background-color: var(--tblr-bg-surface-tertiary);
    color: var(--tblr-secondary-color);
    border-bottom-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .table-hover tbody tr:hover {
    background-color: var(--tblr-active-bg);
}

/* Specific adjustments for elements that might still be white */
[data-bs-theme="dark"] .bg-white {
    background-color: var(--tblr-bg-surface) !important;
}

[data-bs-theme="dark"] .text-dark {
    color: var(--tblr-body-color) !important;
}

[data-bs-theme="dark"] .btn-outline-secondary {
    background-color: #0f172a;
    border-color: #334155;
    color: #f1f5f9;
}

[data-bs-theme="dark"] .btn-outline-secondary:hover {
    background-color: #1e293b;
    border-color: #475569;
    color: #f1f5f9;
}

/* New rules for bg-light and bg-secondary-lt */
[data-bs-theme="dark"] .bg-light {
    background-color: var(--tblr-bg-surface-secondary) !important;
    /* A darker shade for light backgrounds */
}

[data-bs-theme="dark"] .bg-secondary-lt {
    background-color: var(--tblr-secondary-bg-subtle) !important;
    /* Use Tabler's secondary subtle background */
}

/* New rules for active tabs */
[data-bs-theme="dark"] .nav-tabs .nav-link.active {
    background-color: var(--tblr-bg-surface-secondary) !important;
    /* Light gray for selected tab */
    color: var(--tblr-body-color) !important;
    /* Ensure text is readable */
    border-color: var(--tblr-border-color) !important;
    /* Adjust border color */
}

[data-bs-theme="dark"] .nav-tabs .nav-link.active:hover {
    background-color: var(--tblr-bg-surface-secondary) !important;
    /* Keep same on hover */
    color: var(--tblr-body-color) !important;
}

/* General dark mode adjustments for common elements - EXCLUDE TOAST RELATED ELEMENTS */
[data-bs-theme="dark"] div:not(.toast):not(.toast-content):not(.toast-container),
[data-bs-theme="dark"] section,
[data-bs-theme="dark"] ul,
[data-bs-theme="dark"] li,
[data-bs-theme="dark"] form,
[data-bs-theme="dark"] input,
[data-bs-theme="dark"] select,
[data-bs-theme="dark"] textarea {
    background-color: inherit;
    /* Inherit background from parent by default */
    color: inherit;
    /* Inherit color from parent by default */
    border-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] hr {
    border-color: #cccccc;
    /* Light gray for dark mode divider */
}

/* System Alerts Hover State */
[data-bs-theme="dark"] .shadcn-alert-item:hover {
    background-color: var(--tblr-bg-surface-secondary) !important;
    /* Darker background on hover */
    color: var(--tblr-body-color) !important;
    /* Ensure text is visible */
}

[data-bs-theme="dark"] .shadcn-alert-item:hover .shadcn-product-name,
[data-bs-theme="dark"] .shadcn-alert-item:hover .shadcn-product-details {
    color: var(--tblr-body-color) !important;
    /* Ensure nested text is visible */
}

/* Loading Animation */
.page-loader {
    background-color: var(--tblr-body-bg);
    /* Use theme-aware background for loader */
}

[data-bs-theme="dark"] .page-loader .spinner-border {
    color: var(--tblr-primary) !important;
    /* Keep spinner visible */
}

/* Navbar Overlay Blur */
[data-bs-theme="dark"] .nav-overlay {
    backdrop-filter: blur(5px);
    /* Apply blur effect */
    background: rgba(0, 0, 0, 0.7) !important;
    /* Make it slightly darker and ensure it overrides */
}

/* General Badge Styling for Dark Mode */
[data-bs-theme="dark"] .badge {
    background-color: var(--tblr-secondary-bg-subtle) !important;
    /* Use a consistent dark background */
    color: var(--tblr-body-color) !important;
    /* Ensure text is visible */
}

[data-bs-theme="dark"] .dropdown-menu {
    background-color: var(--tblr-bg-surface);
    color: var(--tblr-body-color);
    border-color: var(--tblr-border-color);
}

[data-bs-theme="dark"] .modal-backdrop {
    background-color: rgba(0, 0, 0, 0.5) !important;
}

[data-bs-theme="dark"] .active-menu-item {
    font-weight: bold;
    background-color: #343a40;
    color: #fff;
}

/* TOAST SPECIFIC DARK MODE FIXES */
[data-bs-theme="dark"] .toast {
    background-color: transparent;
    border: none;
}

/* Darken sidebar icons in dark mode */
[data-bs-theme="dark"] .sidebar .nav-link-icon i,
[data-bs-theme="dark"] .sidebar .sidebar-actions i {
    color: #6c757d !important; /* Even darker gray */
}

[data-bs-theme="dark"] .toast-content {
    background-color: var(--tblr-bg-surface) !important;
    border: 1px solid var(--tblr-border-color) !important;
    border-radius: 0.375rem !important;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.3) !important;
}

/* Ensure toast text colors are correct in dark mode */
[data-bs-theme="dark"] .toast-content .text-dark {
    color: var(--tblr-body-color) !important;
}

[data-bs-theme="dark"] .toast-content .text-muted {
    color: var(--tblr-secondary-color) !important;
}

/* Toast color bar styling for dark mode */
[data-bs-theme="dark"] .toast-color-bar {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 4px !important;
    height: 100% !important;
    border-top-left-radius: 0.375rem !important;
    border-bottom-left-radius: 0.375rem !important;
}

/* Ensure the close button is visible in dark mode */
[data-bs-theme="dark"] .toast .btn-close {
    filter: invert(1) grayscale(100%) brightness(200%) !important;
    opacity: 0.6 !important;
}

[data-bs-theme="dark"] .toast .btn-close:hover {
    opacity: 1 !important;
}

/* Toast container styling */
[data-bs-theme="dark"] .toast-container {
    pointer-events: none !important;
}

[data-bs-theme="dark"] .toast-container .toast {
    pointer-events: auto !important;
}